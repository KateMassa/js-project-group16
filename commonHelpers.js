import{i as v,s as w,d as E}from"./assets/main-bec1ca72.js";import{a as l,b as C}from"./assets/vendor-4563c95f.js";class b{async fetchCategories(){try{return(await l.get("https://books-backend.p.goit.global/books/category-list")).data}catch(t){throw console.error("Error fetching categories:",t),t}}async fetchTopCategories(){try{return(await l.get("https://books-backend.p.goit.global/books/top-books")).data}catch(t){throw console.error("Error fetching top categories:",t),t}}async fetchBooksByCategory(t){try{return(await l.get(`https://books-backend.p.goit.global/books/category?category=${t}`)).data}catch(o){throw console.error("Error fetching books by category:",o),o}}async fetchBookById(t){try{return(await l.get(`https://books-backend.p.goit.global/books/${t}`)).data}catch(o){throw console.error("Error fetching book by ID:",o),o}}}const y=document.querySelector(".category-list"),d=document.querySelector(".gallery-list"),L=document.querySelector("#all-categories"),p=document.querySelector(".category-title"),m=new b;async function q(){try{const e=await m.fetchCategories();B(e),L.classList.add("active")}catch(e){console.log("Failed to render show category list:",e)}}q();async function g(){document.querySelectorAll(".category-list-item").forEach(e=>e.classList.remove("active"));try{const e=await m.fetchTopCategories();for(let o=0;o<4;o++)T(e[o]);document.querySelector(".category-list-item").classList.add("active")}catch(e){console.error("Failed to fetch all categories:",e)}document.querySelectorAll(".see-more-btn").forEach(e=>e.addEventListener("click",u))}g();function B(e){const t=e.map(({list_name:o})=>`
        <li class="category-list-item">
            <h4 class="category-name">${o}</h4>
        </li>`).join("");y.innerHTML+=t}function f(e){return e.map(({_id:o,book_image:c,author:n,title:s})=>`
        <li class="gallery-item" id="${o}">
            <img src="${c}" alt="" class="book-cover" />
            <h3 class="book-title">${k(s)}</h3>
            <h5 class="book-author">${k(n)}</h5>
        </li>`).join("")}function T(e){S("Best Sellers Books");const{list_name:o,books:c}=e,n=`
    <li class="gallery-list-group">
      <h3 class="list-group-name">${o}</h3>
        <ul class="gallery-list-item">
          ${f(c)}
        </ul>
      <button class="see-more-btn">See more</button>
    </li>`;d.innerHTML+=n}function x(e){const t=e[0].list_name;S(t);const o=f(e);d.innerHTML=o}async function u(e){const t=e.target.closest("li").children[0].textContent;try{const o=await m.fetchBooksByCategory(t);d.innerHTML="",o.length!=0?(d.style.cssText="flex-direction: row; flex-wrap: wrap",x(o),document.querySelectorAll(".category-list-item").forEach(c=>c.classList.remove("active"))):g(),e.target.closest("li").classList.add("active")}catch(o){console.error("Failed to render page by category:",o)}}function k(e){return e.length>=15?`${e.slice(0,15)}...`:e}function S(e){let t=e.split(" ");const o=t[t.length-1];t=t.slice(0,t.length-1);const c=t.join(" ");p.textContent=`${c}`,p.nextElementSibling.textContent=`${o}`}y.addEventListener("click",u);L.addEventListener("click",g);y.addEventListener("click",function(e){e.target.classList.contains("category-list-item")&&u(e)});const $=new b;document.querySelector(".gallery-list").addEventListener("click",async e=>{const t=e.target.parentNode.getAttribute("id"),o=await $.fetchBookById(t);A(o)});const A=e=>{let t,o;const c=document.querySelector("#modal-template"),n=new C.create(c,{onShow:r=>{document.body.classList.add("modal-opened"),t=h=>{h.key==="Escape"&&r.close()},document.addEventListener("keydown",t),o=h=>{r.close()},r.element().querySelector(".modal-close").addEventListener("click",o)},onClose:r=>{document.removeEventListener("keydown",t),r.element().querySelector(".modal-close").removeEventListener("click",o),document.body.classList.remove("modal-opened")}}),s=n.element();s.querySelector(".book-img").src=e.book_image,s.querySelector(".book-name").innerText=e.title,s.querySelector(".book-author").innerText=e.author,s.querySelector(".book-description").innerText=e.description,s.querySelector(".book-description").innerText=e.description,e.buy_links.forEach(r=>{r.name==="Amazon"?s.querySelector(".book-links-amazon").href=r.url:r.name==="Apple Books"&&(s.querySelector(".book-links-applebook").href=r.url)});const a=s.querySelector(".addToList"),i=s.querySelector(".removeFromList");v(e._id)&&(a.classList.add("hidden"),i.classList.remove("hidden")),a.addEventListener("click",r=>{r.preventDefault(),w(e),s.querySelector(".removeFromList-info").classList.remove("hidden"),a.classList.add("hidden"),i.classList.remove("hidden")}),i.addEventListener("click",r=>{r.preventDefault(),E(e._id),s.querySelector(".removeFromList-info").classList.add("hidden"),a.classList.remove("hidden"),i.classList.add("hidden")}),n.show()};
//# sourceMappingURL=commonHelpers.js.map

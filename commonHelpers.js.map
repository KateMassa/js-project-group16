{"version":3,"file":"commonHelpers.js","sources":["../src/js/header.js","../src/js/modal-window.js"],"sourcesContent":["const menu = document.getElementById('burger-menu');\n\nconst onOpen = () => {\n  menu.classList.add('is-open');\n};\n\nconst onClose = () => {\n  menu.classList.remove('is-open');\n};\n\n// Theme switcher in header\n\nconst themeSwitch = document.getElementById('themeSwitch');\n\nthemeSwitch.addEventListener('change', function () {\n  const logoIcon = document.querySelector('.logo-icon use');\n  if (this.checked) {\n    logoIcon.setAttribute('href', './img/icons.svg#icon-logo-dark');\n  } else {\n    logoIcon.setAttribute('href', './img/icons.svg#icon-logo-light');\n  }\n});\n\n// When loading the page, we check the saved topic\nwindow.addEventListener('DOMContentLoaded', function () {\n  const currentTheme = localStorage.getItem('theme');\n  if (currentTheme) {\n    document.body.classList.add(currentTheme);\n    if (currentTheme === 'dark-theme') {\n      themeSwitch.checked = true;\n    }\n  }\n});\n\n// When the switch state changes\nthemeSwitch.addEventListener('change', function () {\n  if (this.checked) {\n    document.body.classList.add('dark-theme');\n    document.body.classList.remove('light-theme');\n    localStorage.setItem('theme', 'dark-theme');\n  } else {\n    document.body.classList.remove('dark-theme');\n    document.body.classList.add('light-theme');\n    localStorage.setItem('theme', 'light-theme');\n  }\n});\n","import axios from 'axios';\nimport * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\nconst booksListContainer = document.querySelector('#book-list');\n\nfunction getBookIndexInShoppingList(bookData) {\n  let booksShoppingList = localStorage.getItem('booksShoppingList');\n  if (!booksShoppingList) {\n    return -1;\n  }\n  booksShoppingList = JSON.parse(booksShoppingList);\n\n  // Find the index of the book with the given ID\n  const bookIndex = booksShoppingList.findIndex(\n    book => book._id === bookData._id\n  );\n\n  return bookIndex;\n}\n\nfunction addToShoppingList(bookData) {\n  let booksShoppingList = localStorage.getItem('booksShoppingList');\n  if (!booksShoppingList) {\n    booksShoppingList = [];\n  } else {\n    booksShoppingList = JSON.parse(booksShoppingList);\n  }\n\n  // Check if a book with the same ID already exists\n  const existingBookIndex = booksShoppingList.findIndex(\n    item => item._id === bookData._id\n  );\n  if (existingBookIndex === -1) {\n    booksShoppingList.push(bookData);\n\n    localStorage.setItem(\n      'booksShoppingList',\n      JSON.stringify(booksShoppingList)\n    );\n  }\n}\n\nfunction removeFromShoppingList(bookData) {\n  let booksShoppingList = localStorage.getItem('booksShoppingList');\n  if (!booksShoppingList) {\n    return;\n  }\n  booksShoppingList = JSON.parse(booksShoppingList);\n\n  // Find the index of the book with the given ID\n  const bookIndex = booksShoppingList.findIndex(\n    book => book._id === bookData._id\n  );\n  if (bookIndex !== -1) {\n    booksShoppingList.splice(bookIndex, 1);\n    localStorage.setItem(\n      'booksShoppingList',\n      JSON.stringify(booksShoppingList)\n    );\n  }\n}\n\nfunction openModal(bookData) {\n  let escHandlerFn;\n  let closeHandlerFn;\n\n  const template = document.querySelector('#modal-template');\n  const lightbox = new basicLightbox.create(template, {\n    onShow: instance => {\n      document.body.classList.add('modal-opened');\n      escHandlerFn = event => {\n        if (event.key === 'Escape') {\n          instance.close();\n        }\n      };\n      document.addEventListener('keydown', escHandlerFn);\n      closeHandlerFn = e => {\n        document.body.classList.remove('modal-opened');\n        instance.close();\n      };\n      instance\n        .element()\n        .querySelector('.modal-close')\n        .addEventListener('click', closeHandlerFn);\n    },\n    onClose: instance => {\n      document.removeEventListener('keydown', escHandlerFn);\n      instance\n        .element()\n        .querySelector('.modal-close')\n        .removeEventListener('click', closeHandlerFn);\n    },\n  });\n  const modalBody = lightbox.element();\n\n  modalBody.querySelector('.book-img').src = bookData.book_image;\n  modalBody.querySelector('.book-name').innerText = bookData.title;\n  modalBody.querySelector('.book-author').innerText = bookData.author;\n  modalBody.querySelector('.book-description').innerText = bookData.description;\n  modalBody.querySelector('.book-description').innerText = bookData.description;\n\n  bookData.buy_links.forEach(link => {\n    if (link.name === 'Amazon') {\n      modalBody.querySelector('.book-links-amazon').href = link.url;\n    } else if (link.name === 'Apple Books') {\n      modalBody.querySelector('.book-links-applebook').href = link.url;\n    }\n  });\n\n  const addToShoppingListElement = modalBody.querySelector('.addToList');\n  const removeFromShoppingListElement =\n    modalBody.querySelector('.removeFromList');\n\n  if (getBookIndexInShoppingList(bookData) > -1) {\n    // If book already in shopping list\n\n    addToShoppingListElement.classList.add('hidden');\n    removeFromShoppingListElement.classList.remove('hidden');\n  }\n\n  addToShoppingListElement.addEventListener('click', e => {\n    e.preventDefault();\n    addToShoppingList(bookData);\n\n    modalBody.querySelector('.removeFromList-info').classList.remove('hidden');\n    addToShoppingListElement.classList.add('hidden');\n    removeFromShoppingListElement.classList.remove('hidden');\n  });\n\n  removeFromShoppingListElement.addEventListener('click', e => {\n    e.preventDefault();\n    removeFromShoppingList(bookData);\n\n    modalBody.querySelector('.removeFromList-info').classList.add('hidden');\n    addToShoppingListElement.classList.remove('hidden');\n    removeFromShoppingListElement.classList.add('hidden');\n  });\n\n  lightbox.show();\n}\n\nasync function loadBookForModal(link) {\n  try {\n    const { data } = await axios.get(link);\n\n    openModal(data);\n  } catch (e) {\n    console.log(e.message);\n  }\n}\n\nbooksListContainer.addEventListener('click', function (e) {\n  if (e.target.classList.contains('js-open-modal')) {\n    e.preventDefault();\n\n    loadBookForModal(e.target.href);\n  }\n});\n\n// Переключатель теми в хедері\n\nconst themeSwitch = document.getElementById('themeSwitch');\n\n// При загрузці сторінки провіряємо збережену тему\nwindow.addEventListener('DOMContentLoaded', function () {\n  const currentTheme = localStorage.getItem('theme');\n  if (currentTheme) {\n    document.body.classList.add(currentTheme);\n    if (currentTheme === 'dark-theme') {\n      themeSwitch.checked = true;\n    }\n  }\n});\n\n// При зміні стану переключателя\nthemeSwitch.addEventListener('change', function () {\n  if (this.checked) {\n    document.body.classList.add('dark-theme');\n    document.body.classList.remove('light-theme');\n    localStorage.setItem('theme', 'dark-theme');\n  } else {\n    document.body.classList.remove('dark-theme');\n    document.body.classList.add('light-theme');\n    localStorage.setItem('theme', 'light-theme');\n    booksListContainer.addEventListener('click', function (e) {\n      if (e.target.classList.contains('js-open-modal')) {\n        e.preventDefault();\n\n        loadBookForModal(e.target.href);\n      }\n    });\n  }\n});\n"],"names":["themeSwitch","logoIcon","currentTheme","booksListContainer","getBookIndexInShoppingList","bookData","booksShoppingList","book","addToShoppingList","item","removeFromShoppingList","bookIndex","openModal","escHandlerFn","closeHandlerFn","template","lightbox","basicLightbox.create","instance","event","e","modalBody","link","addToShoppingListElement","removeFromShoppingListElement","loadBookForModal","data","axios"],"mappings":"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"}
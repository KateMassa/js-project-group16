{"version":3,"file":"commonHelpers.js","sources":["../src/js/fetchAPI.js","../src/js/render.js","../src/js/modal-window.js"],"sourcesContent":["import axios from 'axios';\n\nexport class BooksApi {\n  constructor() {\n    this.BASE_URL = 'https://books-backend.p.goit.global/books';\n    this.TOP_BOOKS_ENDPOINT = '/top-books';\n    this.CATEGORY_ENDPOINT = '/category?category=';\n    this.CATEGORY_LIST_ENDPOINT = '/category-list';\n  }\n\n  //==== Метод на отримання книг-бестселлерів\n  async getTopBooks() {\n    try {\n      const url = `${this.BASE_URL}${this.TOP_BOOKS_ENDPOINT}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching popular books:', error);\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання книг за категорією\n  async getBooksByCategory(selectedCategory) {\n    try {\n      const url = `${this.BASE_URL}${this.CATEGORY_ENDPOINT}${selectedCategory}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        `Error fetching books for category '${selectedCategory}':`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання додаткової інформації про книгу за id\n  async getDetails(bookId) {\n    try {\n      const url = `${this.BASE_URL}/${bookId}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        `Error fetching details for book with ID '${bookId}':`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання списку категорій книг\n  async getCategoryList() {\n    try {\n      const url = `${this.BASE_URL}${this.CATEGORY_LIST_ENDPOINT}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching category list:', error);\n      throw error;\n    }\n  }\n\n  \n}\nclass BookAPI {\n  async fetchCategories() {\n      try {\n          // Виконуємо GET-запит на сервер\n          const response = await axios.get(`https://books-backend.p.goit.global/books/category-list`);\n          // Повертаємо дані про категорії\n          return response.data;\n      } catch (error) {\n          console.error(\"Error fetching categories:\", error);\n          throw error;\n      }\n  }\n\n  async fetchTopCategories() {\n      try {\n          const response = await axios.get('https://books-backend.p.goit.global/books/top-books');\n          return response.data;\n      } catch (error) {\n          console.error(\"Error fetching top categories:\", error);\n          throw error;\n      }\n  }\n\n  async fetchBooksByCategory(selectedCategory) {\n      try {\n          const response = await axios.get(`https://books-backend.p.goit.global/books/category?category=${selectedCategory}`);\n          return response.data;\n      } catch (error) {\n          console.error(\"Error fetching books by category:\", error);\n          throw error;\n      }\n  }\n\n  async fetchBookById(bookId) {\n      try {\n          const response = await axios.get(`https://books-backend.p.goit.global/books/${bookId}`);\n          return response.data;\n      } catch (error) {\n          console.error(\"Error fetching book by ID:\", error);\n          throw error;\n      }\n  }\n}\n\nexport default BookAPI;  \n","import BookAPI from \"./fetchAPI\";\n\nexport const categoryList = document.querySelector('.category-list'),\n  galleryList = document.querySelector('.gallery-list'),\n  allCategories = document.querySelector('#all-categories'),\n  categoryName = document.querySelector('.category-title');\n\nconst bookAPI = new BookAPI();\n\nasync function showCategoryList() {\n  try {\n    const response = await bookAPI.fetchCategories();\n    renderCategory(response);\n    allCategories.classList.add('active');\n  } catch (error) {\n    console.log(\"Failed to render show category list:\", error);\n  }\n}\n\nshowCategoryList();\n\nasync function showAllCategories() {\n  document.querySelectorAll('.category-list-item').forEach(item => item.classList.remove('active'));\n  try {\n    const response = await bookAPI.fetchTopCategories();\n    for (let i = 0; i < 4; i++) {\n      renderListGroup(response[i]);\n    }\n    const highlightCategory = document.querySelector('.category-list-item');\n    highlightCategory.classList.add('active'); //highlight all categories category item\n\n  } catch (error) {\n    console.error(\"Failed to fetch all categories:\", error);\n  }\n  document.querySelectorAll('.see-more-btn').forEach(\n    item => item.addEventListener('click', renderPageByCategory)\n  );\n}\n\nshowAllCategories();\n\nfunction renderCategory(data) {\n  const markup = data.map(({ list_name }) => {\n    return `\n        <li class=\"category-list-item\">\n            <h4 class=\"category-name\">${list_name}</h4>\n        </li>`;\n  }).join('');\n  categoryList.innerHTML += markup;\n}\n\nfunction renderBooks(data) {\n  const markup = data.map(({ _id, book_image, author, title }) => {\n    return `\n        <li class=\"gallery-item\" id=\"${_id}\">\n            <img src=\"${book_image}\" alt=\"\" class=\"book-cover\" />\n            <h3 class=\"book-title\">${isCorrectTextLength(title)}</h3>\n            <h5 class=\"book-author\">${isCorrectTextLength(author)}</h5>\n        </li>`\n  }).join('');\n  return markup;\n}\n\nfunction renderListGroup(data) {\n  const categoryTitle = 'Best Sellers Books';\n  renderCategoryTitleByColors(categoryTitle);\n\n  const { list_name, books } = data;\n  const markup = `\n    <li class=\"gallery-list-group\">\n      <h3 class=\"list-group-name\">${list_name}</h3>\n        <ul class=\"gallery-list-item\">\n          ${renderBooks(books)}\n        </ul>\n      <button class=\"see-more-btn\">See more</button>\n    </li>`;\n  galleryList.innerHTML += markup;\n}\n\nfunction renderListByCategory(data) {\n  const categoryTitle = data[0].list_name; //беремо назву категорії у першого елемента\n  renderCategoryTitleByColors(categoryTitle);\n  const markup = renderBooks(data);\n  galleryList.innerHTML = markup;\n}\n\nasync function renderPageByCategory(e) {\n  const categoryName = e.target.closest('li').children[0].textContent;\n\n  try {\n    const response = await bookAPI.fetchBooksByCategory(categoryName);\n    galleryList.innerHTML = '';\n\n    if (response.length != 0) {\n      galleryList.style.cssText = 'flex-direction: row; flex-wrap: wrap';\n      renderListByCategory(response);\n      document.querySelectorAll('.category-list-item').forEach(item => item.classList.remove('active'));\n    } else {\n      showAllCategories();\n    }\n    e.target.closest('li').classList.add('active'); //highlight category name\n  } catch (error) {\n    console.error(\"Failed to render page by category:\", error);\n  }\n}\n\nfunction isCorrectTextLength(text) {\n  const maximumSymbolsCount = 15;\n  return (text.length >= maximumSymbolsCount) ? `${text.slice(0, maximumSymbolsCount)}...` : text;\n}\n\nfunction renderCategoryTitleByColors(categoryTitle) {\n  let arrayFromBlackWords = categoryTitle.split(' ');\n  const blueWord = arrayFromBlackWords[arrayFromBlackWords.length - 1];\n  arrayFromBlackWords = arrayFromBlackWords.slice(0, arrayFromBlackWords.length - 1);\n  const blackWords = arrayFromBlackWords.join(' ');\n\n  categoryName.textContent = `${blackWords}`;\n  categoryName.nextElementSibling.textContent = `${blueWord}`;\n}\n\n//додаємо обробники подій\ncategoryList.addEventListener('click', renderPageByCategory);\nallCategories.addEventListener('click', showAllCategories);","import * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\nimport {\n  isBookAlreadyExist,\n  deleteFromLS,\n  saveToLS\n} from './localStorage';\n\nimport BookAPI from './fetchAPI';\n\nconst bookAPI = new BookAPI();\n\ndocument.querySelector('.gallery-list').addEventListener('click', async e => {\n  const bookId = e.target.parentNode.getAttribute('id');\n  const book = await bookAPI.fetchBookById(bookId);\n  showBookDetails(book);\n});\n\nexport const showBookDetails = bookData => {\n  let escHandlerFn;\n  let closeHandlerFn;\n\n  const template = document.querySelector('#modal-template');\n  const lightbox = new basicLightbox.create(template, {\n    onShow: instance => {\n      document.body.classList.add('modal-opened');\n      escHandlerFn = event => {\n        if (event.key === 'Escape') {\n          instance.close();\n        }\n      };\n      document.addEventListener('keydown', escHandlerFn);\n      closeHandlerFn = e => {\n        instance.close();\n      };\n      instance\n        .element()\n        .querySelector('.modal-close')\n        .addEventListener('click', closeHandlerFn);\n    },\n    onClose: instance => {\n      document.removeEventListener('keydown', escHandlerFn);\n      instance\n        .element()\n        .querySelector('.modal-close')\n        .removeEventListener('click', closeHandlerFn);\n      \n      document.body.classList.remove('modal-opened');\n    },\n  });\n  const modalBody = lightbox.element();\n\n  modalBody.querySelector('.book-img').src = bookData.book_image;\n  modalBody.querySelector('.book-name').innerText = bookData.title;\n  modalBody.querySelector('.book-author').innerText = bookData.author;\n  modalBody.querySelector('.book-description').innerText = bookData.description;\n  modalBody.querySelector('.book-description').innerText = bookData.description;\n\n  bookData.buy_links.forEach(link => {\n    if (link.name === 'Amazon') {\n      modalBody.querySelector('.book-links-amazon').href = link.url;\n    } else if (link.name === 'Apple Books') {\n      modalBody.querySelector('.book-links-applebook').href = link.url;\n    }\n  });\n\n  const addToShoppingListElement = modalBody.querySelector('.addToList');\n  const removeFromShoppingListElement =\n    modalBody.querySelector('.removeFromList');\n\n  if (isBookAlreadyExist(bookData._id)) {\n    // If book already in shopping list\n\n    addToShoppingListElement.classList.add('hidden');\n    removeFromShoppingListElement.classList.remove('hidden');\n  }\n\n  addToShoppingListElement.addEventListener('click', e => {\n    e.preventDefault();\n    saveToLS(bookData);\n\n    modalBody.querySelector('.removeFromList-info').classList.remove('hidden');\n    addToShoppingListElement.classList.add('hidden');\n    removeFromShoppingListElement.classList.remove('hidden');\n  });\n\n  removeFromShoppingListElement.addEventListener('click', e => {\n    e.preventDefault();\n    deleteFromLS(bookData._id);\n\n    modalBody.querySelector('.removeFromList-info').classList.add('hidden');\n    addToShoppingListElement.classList.remove('hidden');\n    removeFromShoppingListElement.classList.add('hidden');\n  });\n\n  lightbox.show();\n};\n\n"],"names":["BookAPI","axios","error","selectedCategory","bookId","categoryList","galleryList","allCategories","categoryName","bookAPI","showCategoryList","response","renderCategory","showAllCategories","item","i","renderListGroup","renderPageByCategory","data","markup","list_name","renderBooks","_id","book_image","author","title","isCorrectTextLength","renderCategoryTitleByColors","books","renderListByCategory","categoryTitle","text","arrayFromBlackWords","blueWord","blackWords","book","showBookDetails","bookData","escHandlerFn","closeHandlerFn","template","lightbox","basicLightbox.create","instance","event","e","modalBody","link","addToShoppingListElement","removeFromShoppingListElement","isBookAlreadyExist","saveToLS","deleteFromLS"],"mappings":"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"}
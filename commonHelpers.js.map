{"version":3,"file":"commonHelpers.js","sources":["../src/js/header.js","../src/js/modal-window.js","../src/js/fetchAPI.js","../src/js/bestsellers.js","../src/main.js"],"sourcesContent":["const menu = document.getElementById('burger-menu');\n\nconst onOpen = () => {\n  menu.classList.add('is-open');\n};\n\nconst onClose = () => {\n  menu.classList.remove('is-open');\n};\n","import axios from 'axios';\nimport * as basicLightbox from 'basiclightbox'\nimport \"basiclightbox/dist/basicLightbox.min.css\";\n\n\nconst booksListContainer = document.querySelector('#book-list');\n\nfunction getBookIndexInShoppingList(bookData) {\n    let booksShoppingList = localStorage.getItem(\"booksShoppingList\");\n    if (!booksShoppingList) {\n        return -1;\n    }\n    booksShoppingList = JSON.parse(booksShoppingList);\n\n    // Find the index of the book with the given ID\n    const bookIndex = booksShoppingList.findIndex(book => book._id === bookData._id);\n\n    return bookIndex;\n}\n\nfunction addToShoppingList(bookData) {\n    let booksShoppingList = localStorage.getItem(\"booksShoppingList\");\n    if (!booksShoppingList) {\n        booksShoppingList = [];\n    } else {\n        booksShoppingList = JSON.parse(booksShoppingList);\n    }\n\n    // Check if a book with the same ID already exists\n    const existingBookIndex = booksShoppingList.findIndex(item => item._id === bookData._id);\n    if (existingBookIndex === -1) {\n        booksShoppingList.push(bookData);\n\n        localStorage.setItem(\"booksShoppingList\", JSON.stringify(booksShoppingList));\n    }\n}\n\nfunction removeFromShoppingList(bookData) {\n    let booksShoppingList = localStorage.getItem(\"booksShoppingList\");\n    if (!booksShoppingList) {\n        return;\n    }\n    booksShoppingList = JSON.parse(booksShoppingList);\n\n    // Find the index of the book with the given ID\n    const bookIndex = booksShoppingList.findIndex(book => book._id === bookData._id);\n    if (bookIndex !== -1) {\n        booksShoppingList.splice(bookIndex, 1);\n        localStorage.setItem(\"booksShoppingList\", JSON.stringify(booksShoppingList));\n    }\n}\n\nfunction openModal(bookData) {\n    let escHandlerFn;\n    let closeHandlerFn;\n\n    const template = document.querySelector('#modal-template');\n    const lightbox = new basicLightbox.create(template, {\n        onShow: (instance) => {\n            document.body.classList.add('modal-opened');\n            escHandlerFn = (event) => {\n                if (event.key === \"Escape\") {\n                    instance.close();\n                }\n            };\n            document.addEventListener(\"keydown\", escHandlerFn);\n            closeHandlerFn = (e) => {\n                document.body.classList.remove('modal-opened');\n                instance.close();\n            };\n            instance.element().querySelector('.modal-close').addEventListener('click', closeHandlerFn);\n        },\n        onClose: (instance) => {\n            document.removeEventListener(\"keydown\", escHandlerFn);\n            instance.element().querySelector('.modal-close').removeEventListener('click', closeHandlerFn);\n        }\n    });\n    const modalBody = lightbox.element();\n\n    modalBody.querySelector('.book-img').src = bookData.book_image;\n    modalBody.querySelector('.book-name').innerText = bookData.title;\n    modalBody.querySelector('.book-author').innerText = bookData.author;\n    modalBody.querySelector('.book-description').innerText = bookData.description;\n    modalBody.querySelector('.book-description').innerText = bookData.description;\n\n    bookData.buy_links.forEach((link) => {\n        if (link.name === 'Amazon') {\n            modalBody.querySelector('.book-links-amazon').href = link.url;\n        } else if (link.name === 'Apple Books') {\n            modalBody.querySelector('.book-links-applebook').href = link.url;\n        }\n    });\n\n    const addToShoppingListElement = modalBody.querySelector('.addToList');\n    const removeFromShoppingListElement = modalBody.querySelector('.removeFromList');\n\n    if (getBookIndexInShoppingList(bookData) > -1) {\n        // If book already in shopping list\n\n        addToShoppingListElement.classList.add('hidden');\n        removeFromShoppingListElement.classList.remove('hidden');\n    }\n\n    addToShoppingListElement.addEventListener('click', (e) => {\n        e.preventDefault();\n        addToShoppingList(bookData);\n\n        modalBody.querySelector('.removeFromList-info').classList.remove('hidden');\n        addToShoppingListElement.classList.add('hidden');\n        removeFromShoppingListElement.classList.remove('hidden');\n    });\n\n    removeFromShoppingListElement.addEventListener('click', (e) => {\n        e.preventDefault();\n        removeFromShoppingList(bookData);\n\n        modalBody.querySelector('.removeFromList-info').classList.add('hidden');\n        addToShoppingListElement.classList.remove('hidden');\n        removeFromShoppingListElement.classList.add('hidden');\n    });\n    \n\n    lightbox.show();\n}\n \nasync function loadBookForModal(link) {\n    try {\n        const { data } = await axios.get(link);\n\n        openModal(data);\n    } catch (e) {\n        console.log(e.message);\n    }\n}\n\nbooksListContainer.addEventListener('click', function (e) {\n    if (e.target.classList.contains('js-open-modal')) {\n        e.preventDefault();\n\n        loadBookForModal(e.target.href);\n    }\n});\n\n\n\n// Переключатель теми в хедері\n\nconst themeSwitch = document.getElementById('themeSwitch');\n\n// При загрузці сторінки провіряємо збережену тему\nwindow.addEventListener('DOMContentLoaded', function() {\n  const currentTheme = localStorage.getItem('theme');\n  if (currentTheme) {\n    document.body.classList.add(currentTheme);\n    if (currentTheme === 'dark-theme') {\n      themeSwitch.checked = true;\n    }\n  }\n});\n\n// При зміні стану переключателя\nthemeSwitch.addEventListener('change', function() {\n  if (this.checked) {\n    document.body.classList.add('dark-theme');\n    document.body.classList.remove('light-theme');\n    localStorage.setItem('theme', 'dark-theme');\n  } else {\n    document.body.classList.remove('dark-theme');\n    document.body.classList.add('light-theme');\n    localStorage.setItem('theme', 'light-theme');\n  }\n});\n","import axios from 'axios';\n\nexport class BooksApi {\n  constructor() {\n    this.BASE_URL = 'https://books-backend.p.goit.global/books';\n    this.TOP_BOOKS_ENDPOINT = '/top-books';\n    this.CATEGORY_ENDPOINT = '/category?category=';\n    this.CATEGORY_LIST_ENDPOINT = '/category-list';\n  }\n\n  //==== Метод на отримання книг-бестселлерів\n  async getTopBooks() {\n    try {\n      const url = `${this.BASE_URL}${this.TOP_BOOKS_ENDPOINT}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching popular books:', error);\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання книг за категорією\n  async getBooksByCategory(selectedCategory) {\n    try {\n      const url = `${this.BASE_URL}${this.CATEGORY_ENDPOINT}${selectedCategory}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        `Error fetching books for category '${selectedCategory}':`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання додаткової інформації про книгу за id\n  async getDetails(bookId) {\n    try {\n      const url = `${this.BASE_URL}/${bookId}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error(\n        `Error fetching details for book with ID '${bookId}':`,\n        error\n      );\n      throw error;\n    }\n  }\n\n  //==== Метод на отримання списку категорій книг\n  async getCategoryList() {\n    try {\n      const url = `${this.BASE_URL}${this.CATEGORY_LIST_ENDPOINT}`;\n      const response = await axios.get(url);\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching category list:', error);\n      throw error;\n    }\n  }\n}\n","import { BooksApi } from './fetchAPI';\n\nconst booksApi = new BooksApi();\nconst topBooksList = document.querySelector('.top-books-list');\nconst booksTitleContainer = document.querySelector('.books-title-container');\n\nexport function renderBestsellers() {\n  //====== Записуємо кількість книг до відмальовки з результату функції\n  let limit = calculateLimit(window.innerWidth);\n\n  //===== Запитуємо книги з серверу, передаємо дані в функцію і відмальовуємо\n  booksApi\n    .getTopBooks()\n    .then(data => dataBestsellers(data, limit))\n    .catch(error => console.error('Error fetching top books:', error));\n}\n\n//==== Вираховуємо кількіть книг до відмальовки, в залежності від ширини екрану\nfunction calculateLimit(screenWidth) {\n  if (screenWidth >= 1440) {\n    return 5;\n  } else if (screenWidth >= 768) {\n    return 3;\n  } else {\n    return 1;\n  }\n}\n\n// ==== Функція на відмальовку бестселлерів\nfunction dataBestsellers(data, limit) {\n  topBooksList.innerHTML = '';\n  const dataBestsellers = data\n    .map(elem => {\n      let cardStarterMarkup = `<li><h2 class=\"gallery-title\">${elem.list_name}</h2>\n    <ul class=\"gallery-book-list\" data-filter=\"${elem.list_name}\">`;\n      let booksArray = [];\n      for (let i = 0; i < limit && i < elem.books.length; i++) {\n        let book = `<li class='gallery-book-item' data-bookid=\"${elem.books[i]._id}\">\n        <a class=\"gallery-book-link\">\n        <div class=\"preview\">\n          <img class=\"gallery-book-img js-open-modal\" data-id=\"${elem.books[i]._id}\" src=\"${elem.books[i].book_image}\" alt=\"${elem.books[i].title}\">\n          <div class=\"actions-card\">\n        <p class=\"action-text\">quick view</p>\n          </div>\n        </div>\n          <div class=\"content\">\n            <h3 class=\"gallery-book-name\">${elem.books[i].title}</h3>\n            <h4 class=\"gallery-book-text\">${elem.books[i].author}</h4>\n          </div>\n        </a>\n      </li>`;\n        booksArray.push(book);\n      }\n\n      const booksTemplate = booksArray.join(' ');\n      return cardStarterMarkup + booksTemplate + '</ul>' + '' + '</li>';\n    })\n    .join(' ');\n\n  topBooksList.innerHTML = dataBestsellers;\n  const dataMarkupTitle = `<h2 class=\"top-books-title\">Best Sellers <span class=\"colortext\">Books</span></h2>`;\n  booksTitleContainer.innerHTML = dataMarkupTitle;\n}\n\n//===== Зміна кількості книг до відмальовки при зміні ширини екрану\nwindow.addEventListener('resize', () => {\n  let limit = calculateLimit(window.innerWidth);\n  renderBestsellers(limit);\n});\n","// === Відображення блоку книг бестселлерів\n\nimport { renderBestsellers } from './js/bestsellers';\nrenderBestsellers();\n"],"names":["booksListContainer","getBookIndexInShoppingList","bookData","booksShoppingList","book","addToShoppingList","item","removeFromShoppingList","bookIndex","openModal","escHandlerFn","closeHandlerFn","template","lightbox","basicLightbox.create","instance","event","e","modalBody","link","addToShoppingListElement","removeFromShoppingListElement","loadBookForModal","data","axios","themeSwitch","currentTheme","BooksApi","url","error","selectedCategory","bookId","booksApi","topBooksList","booksTitleContainer","renderBestsellers","limit","calculateLimit","dataBestsellers","screenWidth","elem","cardStarterMarkup","booksArray","i","booksTemplate","dataMarkupTitle"],"mappings":"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"}